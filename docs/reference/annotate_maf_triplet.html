<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Annotate MAF with triplet context — annotate_maf_triplet • GAMBLR.results</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Annotate MAF with triplet context — annotate_maf_triplet"><meta property="og:description" content="Give triple sequence of mutated base with its adjacent bases (-1
and +1)"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">GAMBLR.results</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Annotate MAF with triplet context</h1>
    
    <div class="hidden name"><code>annotate_maf_triplet.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Give triple sequence of mutated base with its adjacent bases (-1
and +1)</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">annotate_maf_triplet</span><span class="op">(</span></span>
<span>  <span class="va">maf</span>,</span>
<span>  all_SNVs <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">ref</span>,</span>
<span>  <span class="va">alt</span>,</span>
<span>  <span class="va">genome_build</span>,</span>
<span>  <span class="va">fastaPath</span>,</span>
<span>  pyrimidine_collapse <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>maf</dt>
<dd><p>MAF file (required columns: Reference_Allele, Tumor_Seq_Allele2)</p></dd>


<dt>all_SNVs</dt>
<dd><p>To give us all the triplet sequences of SNVs and not
specifying any specific ref and alt alleles (default is TRUE)</p></dd>


<dt>ref</dt>
<dd><p>Reference allele</p></dd>


<dt>alt</dt>
<dd><p>Alternative allele</p></dd>


<dt>genome_build</dt>
<dd><p>The genome build for the variants you are
working with (default is to infer it from the MAF)</p></dd>


<dt>fastaPath</dt>
<dd><p>Can be a path to a FASTA file on a disk. When on GSC,
this is first attempted to be inferred from the gambl reference through
path specified in config. Local files are also accepted as value here.</p></dd>


<dt>pyrimidine_collapse</dt>
<dd><p>Estimate mutation_strand and</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A data frame with two to three extra columns, in case
pyrimidine_collapse = FALSE, it will add triple sequence (seq) and the
strand (mutation_strand). When pyrimidine_collapse = T, another column
also will be added to the those extra columns which shows the mutation
(mutation)</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>It gives the reference and alternative alleles and looks for the
rows of the data frame based on these values for + strand genes and their
complement alleles rows for - strand genes, then it can look for the adjacent
bases in that mutation position. Also, it can look for all the SNVs in
the MAF data frame and provide triple sequences for them (reverse complement
sequence for the - strand).</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">maf</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_coding_ssm.html">get_coding_ssm</a></span><span class="op">(</span>projection <span class="op">=</span> <span class="st">"grch37"</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>One or more parsing issues, call `problems()` on your data frame for details,</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> e.g.:</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>   dat &lt;- vroom(...)</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>   problems(dat)</span>
<span class="r-in"><span><span class="co"># peek at the data</span></span></span>
<span class="r-in"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">maf</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> genomic_data Object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Genome Build: grch37 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Showing first 10 rows:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Hugo_Symbol Entrez_Gene_Id Center NCBI_Build Chromosome Start_Position</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    AL627309.1              0      .     GRCh37          1         138626</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    AL627309.1              0      .     GRCh37          1         138972</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 RP11-206L10.9              0      .     GRCh37          1         730845</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4        FAM87B              0      .     GRCh37          1         753589</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5        SAMD11              0      .     GRCh37          1         871158</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6        SAMD11              0      .     GRCh37          1         871192</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   End_Position Strand Variant_Classification Variant_Type Reference_Allele</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       138626      +                 Silent          SNP                T</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       138973      +        Frame_Shift_Ins          INS                -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       730845      +          Splice_Region          SNP                G</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4       753589      +          Splice_Region          SNP                A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5       871158      +                 Silent          SNP                C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6       871192      +      Missense_Mutation          SNP                C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Tumor_Seq_Allele1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                 T</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                 -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                 G</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4                 A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5                 C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6                 C</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">maf_anno</span> <span class="op">&lt;-</span> <span class="fu">annotate_maf_triplet</span><span class="op">(</span><span class="va">maf</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">maf_anno</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">12</span>, <span class="va">seq</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> genomic_data Object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Genome Build: grch37 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Showing first 10 rows:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Hugo_Symbol Entrez_Gene_Id Center NCBI_Build Chromosome Start_Position</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    AL627309.1              0      .     GRCh37          1         138626</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    AL627309.1              0      .     GRCh37          1         138972</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 RP11-206L10.9              0      .     GRCh37          1         730845</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4        FAM87B              0      .     GRCh37          1         753589</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5        SAMD11              0      .     GRCh37          1         871158</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6        SAMD11              0      .     GRCh37          1         871192</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   End_Position Strand Variant_Classification Variant_Type Reference_Allele</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       138626      +                 Silent          SNP                T</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       138973      +        Frame_Shift_Ins          INS                -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       730845      +          Splice_Region          SNP                G</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4       753589      +          Splice_Region          SNP                A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5       871158      +                 Silent          SNP                C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6       871192      +      Missense_Mutation          SNP                C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Tumor_Seq_Allele1 seq</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                 T ATG</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                 -  NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                 G CGT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4                 A AAA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5                 C ACG</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6                 C CCG</span>
<span class="r-in"><span><span class="co"># Each mutation is now associated with it's sequence context in the</span></span></span>
<span class="r-in"><span><span class="co"># reference genome in a column named seq</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu">annotate_maf_triplet</span><span class="op">(</span><span class="va">maf</span>, all_SNVs <span class="op">=</span> <span class="cn">FALSE</span>, <span class="st">"C"</span>, <span class="st">"T"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">annotate_maf_triplet</span><span class="op">(</span><span class="va">maf</span>, ref <span class="op">=</span> <span class="st">"C"</span>, alt <span class="op">=</span> <span class="st">"T"</span>, pyrimidine_collapse <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Ryan Morin, Kostiantyn Dreval, Vladimir Souza.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

