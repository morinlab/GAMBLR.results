<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Get CN Segments. — get_cn_segments • GAMBLR.results</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Get CN Segments. — get_cn_segments"><meta name="description" content="Retrieve all copy number segments from the GAMBL outputs"><meta property="og:description" content="Retrieve all copy number segments from the GAMBL outputs"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">GAMBLR.results</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/GAMBLR-results.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Developers</h6></li>
    <li><a class="dropdown-item" href="../articles/testing.html">Testing GAMBLR packages</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Get CN Segments.</h1>

      <div class="d-none name"><code>get_cn_segments.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Retrieve all copy number segments from the GAMBL outputs</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">get_cn_segments</span><span class="op">(</span></span>
<span>  <span class="va">these_samples_metadata</span>,</span>
<span>  projection <span class="op">=</span> <span class="st">"grch37"</span>,</span>
<span>  flavour <span class="op">=</span> <span class="st">"combined"</span>,</span>
<span>  <span class="va">this_seq_type</span>,</span>
<span>  fill_missing_with <span class="op">=</span> <span class="st">"nothing"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-these-samples-metadata">these_samples_metadata<a class="anchor" aria-label="anchor" href="#arg-these-samples-metadata"></a></dt>
<dd><p>User must provide a metadata table to restrict the data to the samples in your table.
The metadata also ensures the proper handling of duplicate sample_id across seq_types and ensures the
seq_type in the metadata faithfully represents the seq_type of the data</p></dd>


<dt id="arg-projection">projection<a class="anchor" aria-label="anchor" href="#arg-projection"></a></dt>
<dd><p>Desired genome coordinate system for returned CN segments. Default is "grch37".</p></dd>


<dt id="arg-flavour">flavour<a class="anchor" aria-label="anchor" href="#arg-flavour"></a></dt>
<dd><p>Specify what pipeline or source of data to use.
Available options are "combined" or "battenberg". Battenberg outputs are incomplete.</p></dd>


<dt id="arg-this-seq-type">this_seq_type<a class="anchor" aria-label="anchor" href="#arg-this-seq-type"></a></dt>
<dd><p>Deprecated.</p></dd>


<dt id="arg-fill-missing-with">fill_missing_with<a class="anchor" aria-label="anchor" href="#arg-fill-missing-with"></a></dt>
<dd><p>Specify how to fill values in dummy segments that were created to satisfy GISTIC.
The default is "nothing", which causes these to be dropped so empty regions
can be handled in subsequent processing steps. For creating a GISTIC input,
you would typically want to set this to "avg_ploidy".
This is taken care of for you by <a href="https://rdrr.io/pkg/GAMBLR.utils/man/prepare_gistic_inputs.html" class="external-link">GAMBLR.utils::prepare_gistic_inputs</a></p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Set to TRUE for a chattier experience</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame with CN segments for the specified region.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This merely loads and returns all the seg_data available for a projection
(genome build) and can assign a single value to dummy segments if they are
present/identified in the source file</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Example for just exome/capture samples:</span></span></span>
<span class="r-in"><span><span class="co"># Get metadata for just a few capture samples</span></span></span>
<span class="r-in"><span><span class="va">capture_metadata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span><span class="fu"><a href="get_gambl_metadata.html">get_gambl_metadata</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">seq_type</span> <span class="op">==</span> <span class="st">"capture"</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Load the copy number segments for capture samples using hg38 projection</span></span></span>
<span class="r-in"><span><span class="va">capture_segments_hg38</span> <span class="op">&lt;-</span> <span class="fu">get_cn_segments</span><span class="op">(</span></span></span>
<span class="r-in"><span>  these_samples_metadata <span class="op">=</span> <span class="va">capture_metadata</span>,</span></span>
<span class="r-in"><span>  projection <span class="op">=</span> <span class="st">"hg38"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> dummy segments are not annotated in the inputs</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> fill_missing_with parameter will be ignored</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">capture_segments_hg38</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SEG Data Object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Genome Build: hg38 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Showing first 10 rows:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 ID chrom    start      end LOH_flag log.ratio seg_seq_type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  00-22011_tumorB  chr1    10001    69372       NA    0.0000      capture</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  00-22011_tumorB  chr1    69373 10335564       NA    1.0000      capture</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  00-22011_tumorB  chr1 10335564 12723042       NA    0.0000      capture</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  00-22011_tumorB  chr1 12723043 13184564       NA    0.0000      capture</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  00-22011_tumorB  chr1 13184565 33302847       NA    0.0000      capture</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  00-22011_tumorB  chr1 33302847 33309697       NA    2.5453      capture</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  00-22011_tumorB  chr1 33309697 40850005       NA    0.0000      capture</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  00-22011_tumorB  chr1 40850005 40922631       NA    2.8912      capture</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  00-22011_tumorB  chr1 40922631 47396477       NA    0.0000      capture</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 00-22011_tumorB  chr1 47396477 47439416       NA    2.0000      capture</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          CN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   2.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   4.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   2.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   2.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   2.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  11.67459</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   2.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  14.83775</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   2.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  8.00000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">genome_metadata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span><span class="fu"><a href="get_gambl_metadata.html">get_gambl_metadata</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">seq_type</span> <span class="op">==</span> <span class="st">"genome"</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Create a metadata table with a mix of seq_types</span></span></span>
<span class="r-in"><span><span class="va">mixed_seq_type_meta</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">capture_metadata</span>, <span class="va">genome_metadata</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## We can load the copy number segments for all samples across seq_types</span></span></span>
<span class="r-in"><span><span class="va">capture_segments_default</span> <span class="op">&lt;-</span> <span class="fu">get_cn_segments</span><span class="op">(</span></span></span>
<span class="r-in"><span>  these_samples_metadata <span class="op">=</span> <span class="va">mixed_seq_type_meta</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> dummy segments are not annotated in the inputs</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> fill_missing_with parameter will be ignored</span>
<span class="r-in"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">capture_segments_default</span>, <span class="va">ID</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 12 × 2</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    ID                    n</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> 00-12637_CLC02086   116</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> 00-14595_tumorB     144</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> 00-14595_tumorC     166</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> 00-14595_tumorD     142</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> 00-22011_tumorB     598</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> FL1011T1          <span style="text-decoration: underline;">22</span>548</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> FL1011T2            134</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> PA003               225</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> PA007               297</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> PA065              <span style="text-decoration: underline;">3</span>903</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">11</span> PA081               200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">12</span> PTCL002_tumour      195</span>
<span class="r-in"><span><span class="co"># Note the default projection is "grch37"</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">capture_segments_default</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SEG Data Object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Genome Build: grch37 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Showing first 10 rows:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 ID chrom    start      end LOH_flag log.ratio seg_seq_type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  00-22011_tumorB     1    10001    69372       NA    0.0000      capture</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  00-22011_tumorB     1    69373 10395622       NA    1.0000      capture</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  00-22011_tumorB     1 10395622 12783034       NA    0.0000      capture</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  00-22011_tumorB     1 12783034 13292951       NA   -2.0000      capture</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  00-22011_tumorB     1 13292951 33768448       NA    0.0000      capture</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  00-22011_tumorB     1 33768448 33775298       NA    2.5453      capture</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  00-22011_tumorB     1 33775298 41315677       NA    0.0000      capture</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  00-22011_tumorB     1 41315677 41388303       NA    2.8912      capture</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  00-22011_tumorB     1 41388303 47862149       NA    0.0000      capture</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 00-22011_tumorB     1 47862149 47905088       NA    2.0000      capture</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          CN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   2.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   4.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   2.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   0.50000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   2.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  11.67459</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   2.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  14.83775</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   2.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  8.00000</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ryan Morin, Kostiantyn Dreval, Vladimir Souza.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer></div>





  </body></html>

